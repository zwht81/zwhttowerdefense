#include "map.h"
#include <QPainter>
#include <iostream>


using namespace std;



Map::Map()
{

}


void Map::initialmap(int num){
    int map1[16][27] =
    {
        0, 0, 0, 4, 6, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 6, 6, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 1, 1, 2, 6, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 1, 1, 6, 6, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2, 6, 1, 1, 2, 6, 0, 0, 0, 0,
        0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 6, 6, 1, 1, 6, 6, 0, 0, 0, 0,
        0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2, 6, 1, 1, 2, 6, 0, 0, 0, 0,
        0, 2, 6, 1, 1, 2, 6, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 6, 6, 1, 1, 6, 6, 0, 0, 0, 0,
        0, 6, 6, 1, 1, 6, 6, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2, 6, 1, 1, 2, 6, 0, 0, 0, 0,
        0, 0, 0, 1, 1, 2, 6, 0, 0, 2, 6, 0, 0, 2, 6, 0, 0, 6, 6, 1, 1, 6, 6, 0, 0, 0, 0,
        0, 0, 0, 1, 1, 6, 6, 0, 0, 6, 6, 0, 0, 6, 6, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 5, 6, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 6, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    };
    int map2[16][27] =
    {
        0, 0, 0, 4, 6, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 6, 6, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 1, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 1, 1, 2, 6, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 1, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 1, 1, 6, 6, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 1, 1, 0, 0, 1, 1, 2, 6, 1, 1, 2, 6, 0, 0, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 1, 1, 0, 0, 1, 1, 6, 6, 1, 1, 6, 6, 0, 0, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 1, 1, 2, 6, 1, 1, 0, 0, 1, 1, 0, 0, 0, 0, 2, 6, 1, 1, 2, 6, 0, 0, 0, 0,
        0, 2, 6, 1, 1, 6, 6, 1, 1, 0, 0, 1, 1, 0, 0, 0, 0, 6, 6, 1, 1, 6, 6, 0, 0, 0, 0,
        0, 6, 6, 1, 1, 0, 0, 1, 1, 2, 6, 1, 1, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 1, 1, 0, 0, 1, 1, 6, 6, 1, 1, 0, 0, 0, 0, 2, 6, 1, 1, 2, 6, 0, 0, 0, 0,
        0, 0, 0, 1, 1, 2, 6, 1, 1, 0, 0, 1, 1, 2, 6, 0, 0, 6, 6, 1, 1, 6, 6, 0, 0, 0, 0,
        0, 0, 0, 1, 1, 6, 6, 1, 1, 0, 0, 1, 1, 6, 6, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 1, 1, 1, 1, 1, 1, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 5, 6, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 1, 1, 1, 1, 1, 1, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 6, 6, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    };

    int map3[16][27] =
    {
        0, 0, 0, 4, 6, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 6, 6, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 6, 0, 0, 2, 6, 1, 1, 2, 6, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 2, 6, 0, 0, 0, 1, 1, 6, 6, 0, 0, 6, 6, 1, 1, 6, 6, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 6, 6, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 2, 6, 1, 1, 2, 6, 0, 0, 0, 0,
        0, 2, 6, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 6, 6, 1, 1, 6, 6, 0, 0, 0, 0,
        0, 6, 6, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2, 6, 1, 1, 2, 6, 0, 0, 0, 0,
        0, 0, 0, 1, 1, 2, 6, 0, 0, 2, 6, 0, 0, 2, 6, 0, 0, 6, 6, 1, 1, 6, 6, 0, 0, 0, 0,
        0, 0, 0, 1, 1, 6, 6, 0, 0, 6, 6, 0, 0, 6, 6, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 5, 6, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 6, 6, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    };



    int i,j;
    switch (num) {
    case 1:
        for(i=0;i<16;i++)
            for(j=0;j<27;j++)
                maparr[i][j]=map1[i][j];

        break;
    case 2:
        for(i=0;i<16;i++)
            for(j=0;j<27;j++)
                maparr[i][j]=map2[i][j];

        break;
    case 3:
        for(i=0;i<16;i++)
            for(j=0;j<27;j++)
                maparr[i][j]=map3[i][j];

        break;


    default:
        break;
    }

    grass.load(":/image/Grass.png");
    road.load(":/image/Road.png");
    towerarea.load(":/image/Towerarea.jpg");
    entrance.load(":/image/entrance.jpg");
    home.load(":/image/home4.png");
    for ( j = 0; j < 16; j++)
        for ( i = 0; i < 27; i++){
            switch (maparr[j][i]){
            case 2:
                _towerarea.push_back(new Towerarea(i * 40, j * 40));
            }
        }
}

void Map::drawmap(QPainter *painter){
    for (int j = 0; j < 16; j++)
        for (int i = 0; i < 27; i++)
        {
            switch (maparr[j][i])
            {
            case 0:     /*草地*/
                painter->drawPixmap(i * 40, j * 40, 40, 40,grass);
                break;
            case 1:     /*地面*/
                painter->drawPixmap(i * 40, j * 40, 40, 40,road);
                break;
            case 2:     /*防御塔坑*/
                painter->drawPixmap(i * 40, j * 40, 80, 80,towerarea);


                //防御塔坑坐标初始化塔坑坐标，插入到塔坑对象数组

                break;
            case 4:
                painter->drawPixmap(i * 40, j * 40, 80, 80,entrance);
                break;

            case 5:

                painter->drawPixmap((i+1) * 40, j * 40, 40, 40,road);
                painter->drawPixmap(i * 40, (j+1) * 40, 40, 40,road);
                painter->drawPixmap(i * 40, j * 40, 40, 40,road);
                painter->drawPixmap((i+1) * 40, (j+1) * 40, 40, 40,road);
                painter->drawPixmap(i * 40, j * 40, 80, 80,home);
                break;
            }
        }
}
